Array.prototype.unique=function(){var b=this.concat();for(var d=0;d<b.length;++d){for(var c=d+1;c<b.length;++c){if(b[d]===b[c]){b.splice(c,1)}}}return b};Object.kcGetSize=function(c){var b=0,a;for(a in c){if(c.hasOwnProperty(a)){b++}}return b};var win=window.dialogArguments||opener||parent||top;var kcGetSNS=function(f,d){if(!d.hasOwnProperty(f)){return false}var b=function(g){if(!g.hasOwnProperty("data")){return}var h=g.data.split(" = ",2);window[h[0].substr(4)]=JSON.parse(h[1].replace(/;$/,""))};var c=[];if(!d[f].hasOwnProperty("deps")){c.push(d[f].src);b(d[f])}else{for(var e=0;e<d[f].deps.length;e++){if(!d.hasOwnProperty(d[f].deps[e])){continue}var a=d[d[f].deps[e]];if(a.hasOwnProperty("queue")&&!a.queue&&a.hasOwnProperty("src")){c.push(a.src);b(a)}}}return c};(function(d,b){win.kcFileMultiple=function(i){var e=win.kcSettings.upload.target,j=e.data("currentFiles"),g=e.children().last(),k=d(),f=null;for(var h in i){if(!i.hasOwnProperty(h)||d.inArray(i[h].id,j)>-1){continue}f=g.clone().removeClass("hidden");f.find("img").attr("src",i[h].img);f.find("input").val(i[h].id).prop("checked",false);f.find(".title").text(i[h].title);k=k.add(f)}e.append(k);if(g.is(".hidden")){k.show();g.remove()}e.show().prev(".info").show()};win.kcFileSingle=function(i){var e=win.kcSettings.upload.target,h=e.find("span").text(i.title),g=e.find("img").attr("src",i.img);e.removeAttr("data-type");e.find("input").val(i.id);e.children("a.up").hide();e.find("p").fadeIn().children("a.up").show().siblings("a.rm").show();if(i.type=="image"){e.attr("data-type",i.type);h.hide();var f=e.data("size");if(f!=="thumbnail"){d.ajax({type:"POST",url:ajaxurl,data:{action:"kc_get_image_url",id:i.id,size:f},success:function(j){if(j){g.attr("src",j)}}})}}else{h.show()}};var c=d(b);var a=d(".kcs-file, .kcs-file-single");if(a.length){Modernizr.load(kcGetSNS("thickbox",kcSettings.js).concat(kcGetSNS("thickbox",kcSettings.css)))}Modernizr.load({test:kcSettings.mediaFields.length,yep:kcGetSNS("kc_media_selector",kcSettings.js)});c.on("click",".kcs-file a.rm",function(g){g.preventDefault();var f=d(this).closest(".row");f.addClass("removing").fadeOut("slow",function(){if(f.siblings().length){f.remove()}else{f.removeClass("removing").addClass("hidden").find(":input").val("").prop("checked",false);d("input.fileID",f).prop("disabled",true);f.parent().hide().prev(".info").hide()}})});c.on("click","a.kcsf-upload",function(j){j.preventDefault();var h=d(this),f=h.siblings(".kc-rows"),g=f.find(".row.hidden"),i=[];if(g.length){d("input.fileID",g).prop("disabled",false)}else{d("input.fileID",f).each(function(){i.push(this.value)})}win.kcSettings.upload.target=f.data("currentFiles",i);win.kcSettings.upload.mimeType=h.closest("div.kcs-file").data("mime-type");tb_show("",h.attr("href"))});c.on("click",".kcs-file-single a.rm",function(f){f.preventDefault();d(this).fadeOut().closest("div").find("p.current").fadeOut(function(){d(this).siblings("a.up").show().siblings("input").val("")})});c.on("click",".kcs-file-single a.up",function(g){g.preventDefault();var f=d(this);win.kcSettings.upload.target=f.closest("div");win.kcSettings.upload.mimeType=f.closest("div.kcs-file-single").data("mime-type");tb_show("",f.attr("href"))})})(jQuery,document);function kcCountObj(c){var b=0;for(var a in c){if(c.hasOwnProperty(a)){++b}}return b}function kcsbSlug(a){strNu=a.replace(/^\-+/,"");strNu=strNu.replace(/^_+/,"");strNu=strNu.replace(/[^A-Za-z0-9\-_]/g,"");if(strNu.match(/^\-+/)||strNu.match(/^_+/)){strNu=kcsbSlug(strNu)}return strNu}(function(e,i){var a="kcPostFinder",c=false,l=e(i),k=[".kc-find-post"],g,f,b,j,h,d=function(){return k.join(", ")};activate=function(){f=e("#find-posts-input");b=e("#find-posts-response");j=e("#find-posts-submit");h=e("#find-posts-close");j.on("click.kcPostFinder",function(q){q.preventDefault();if(!g.data("kcTarget")){return}var o=b.find("input:checked");if(!o.length){return false}var m=g.data("kcTarget"),p=m.val(),p=p===""?[]:p.split(","),n=o.val();if(m.is(".unique")){m.val(n)}else{if(e.inArray(n,p)<0){p.push(n);m.val(p.join(","))}}});l.on("dblclick.kcPostFinder",'input[name="found_post_id"]',function(){j.trigger("click.kcPostFinder")});l.on("click.kcPostFinder","#find-posts-close",function(){f.val("");g.removeData("kcTarget")});c=true},deactivate=function(){unbind();j.off("click.kcPostFinder");l.off("dblclick.kcPostFinder");l.off("click.kcPostFinder");g=f=b=j=h=null;c=false},action=function(m){g.data("kcTarget",e(this));findPosts.open()},bind=function(){l.on("dblclick.kcPostFinder",d(),action)},unbind=function(){l.off("dblclick.kcPostFinder",d(),action)},publicMethod=e[a]=function(m){var n=this;if(c){if(!m){return}unbind()}else{g=e("#find-posts");if(!g.length){return}activate()}if(m){k=k.concat(m.split(","))}bind();return n};publicMethod.destroy=function(){deactivate()}}(jQuery,document));(function(h,m){var c="kcRowCloner",d=false,o=h(m),f=["text","textarea","color","date","datetime","datetime-local","month","week","email","password","number","tel","time","url"],j={add:[],afterAdd:[],del:[]},g=function(){l();d=true},b=function(){p();d=false;j={add:[],afterAdd:[],del:[]}},e=function(w){var u=h(w.target),t;if(u.is("a.add")){t=q}else{if(u.is("a.del")){t=n}else{if(u.is("a.clear")){i(h(this));w.stopPropagation();return}else{return}}}w.preventDefault();var r=h(this),v=!r.next(".row").length,s=r.parent();t.call(w,{anchor:u,item:r,mode:r.data("mode"),isLast:v,block:s});w.stopPropagation()},q=function(s){var t=this,r=i(s.item.clone(false).addClass("adding").hide());h(".hasdep",r).kcFormDep();s.nuItem=r.insertAfter(s.item);s.block=s.block.kcReorder(s.mode,true);a("add",t,s);s.nuItem.fadeIn("fast",function(){s.nuItem.find("a.rm").trigger("click");a("afterAdd",t,s);setTimeout(function(){s.nuItem.removeClass("adding")},1500)})},n=function(r){var s=this;if(!r.item.siblings(".row").length){r.item=i(r.item);r.item.find(".hasdep").trigger("change");r.removed=false;a("del",s,r)}else{r.removed=true;r.item.addClass("removing").fadeOut("slow",function(){r.item.remove();if(!r.isLast){r.block=r.block.kcReorder(r.mode,true)}delete r.item;a("del",s,r)})}},i=function(r){r.find(":input").each(function(){var t=h(this),s=this.type;if(t.data("nocleanup")===true){return}if(h.inArray(s,f)>-1){t.removeAttr("style").val("")}else{if(s==="checkbox"||s==="radio"){t.prop("checked",this.checked)}}});r.find(".kcs-file-single p.current").removeAttr("style");return r},a=function(u,t,r){for(var s=0;s<j[u].length;s++){j[u][s].call(t,r)}},l=function(){o.on("click.kcRowCloner","li.row",e)},p=function(){o.off("click.kcRowCloner","li.row",e)},k=h[c]=function(){var r=this;if(d){return}g();return r};k.destroy=function(){b()};k.addCallback=function(r,s){if(j.hasOwnProperty(r)&&h.isFunction(s)){j[r].push(s)}}})(jQuery,document);(function(a){var b=a(document);a.fn.kcGoto=function(c){defaults={offset:-20,speed:800};c=a.extend({},defaults,c);return this.each(function(){var d=a(this);d.fadeIn(function(){a("html, body").stop().animate({scrollTop:(d.offset().top+c.offset)},c.speed)})})};a.fn.kcFormDep=function(d){var e={disable:true,callback:function(){}},d=a.extend({},e,d),c=function(g){var f=a(g.target),h=f.val();f.data("depTargets").each(function(){var k=a(this);if(g.kcfdInit===true){if(k.data("kcfdInit")){return}else{k.data("kcfdInit",true)}}var j=k.data("dep"),i=false;if(!f.prop("disabled")&&(((typeof j==="string"||typeof j==="number")&&(j==h||a.inArray(j,h)>-1))||(typeof j==="object"&&a.inArray(h,j)>-1))){i=true}k.toggle(i);if(d.disable===true){k.find(":input").prop("disabled",!i).trigger("change")}})};return this.each(function(){var f=a(this),h=f.val(),g=(f.data("scope")!==undefined)?f.closest(f.data("scope")).children(f.data("child")):a(f.data("child"));if(g.length){f.data("depTargets",g).on("change",c).trigger({type:"change",kcfdInit:true})}})};a.fn.kcReorder=function(j,e){var h=new RegExp(j+"\\]\\[(\\d+)"),g=new RegExp(j+"\\-(\\d+)"),d=a(this);if(e===true){var f=d.children(),c=0}else{var f=d,c=d.index()}f.each(function(){var i=a(this);i.find(":input").each(function(){this.name=this.name.replace(h,function(l,k){return j+"]["+c});if(this.id!==""){this.id=this.id.replace(g,function(l,k){return j+"-"+c})}});i.find("label").each(function(){var k=a(this),l=k.attr("for");if(l!==""&&l!==undefined){k.attr("for",l.replace(g,function(n,m){return j+"-"+c}))}});c++});return this};a.fn.kcTabs=function(){var c=function(g){g.preventDefault();var d=a(g.currentTarget),f=d.parent();if(f.hasClass("tabs")){return}d.closest("ul").data("kcTabsPanels").hide().filter(d.data("kcTabsPanel")).show();f.addClass("tabs").siblings().removeClass("tabs")};return this.each(function(){var e=a(this),d=a();$panels=a();e.children().each(function(f){var g=a(this).children("a").first();if(!g.length){return}var h=a(g.attr("href"));if(!h.length){return}$panels=$panels.add(h);d=d.add(g);g.data("kcTabsPanel",h).on("click",c)});e.data({kcTabsPanels:$panels,kcTabsAnchors:d});d.first().trigger("click")})};a.fn.kcMetaboxDeps=function(){var c=a(this),e=c.find("div.metabox-holder");if(!e.length){return c}var g=e.attr("id"),f=c.find(":checkbox");if(!f.length){return c}var d=a();f.each(function(){var j=a("#"+g+"-"+this.value);if(!j.length){return}var i=a(this),h=a("#"+g+"-"+this.value+"-hide");i.data("sectHider",h).data("sectBox",j);if(!(this.checked===h[0].checked)){h.prop("checked",this.checked).triggerHandler("click")}d=d.add(i)});if(!d.length){return c}d.change(function(){var h=a(this);h.data("sectHider").prop("checked",this.checked).triggerHandler("click");if(this.checked){h.data("sectBox").kcGoto({offset:-40,speed:"slow"})}})};a.fn.kcChosen=function(){var c=a(this);if(!c.length){return this}Modernizr.load([{load:kcGetSNS("chosen",kcSettings.js).concat(kcGetSNS("chosen",kcSettings.css)),complete:function(){c.each(function(){var e=a(this);e.children('option[value=""]').remove();var d=(e.prop("multiple"))?"100%":e.width()+25;e.css("width",d);e.chosen({allow_single_deselect:!e.prop("required")})})}}])};a.fn.kcPFiColor=function(){if(!this.length){return this}if(Modernizr.inputtypes.color!==false){a(this).addClass("hasNative");return this}var c=a(this);if(typeof a.fn.wpColorPicker!=="function"){return Modernizr.load([{load:kcGetSNS("wp_color_picker",win.kcSettings.js).concat(kcGetSNS("wp_color_picker",win.kcSettings.css)),complete:function(){c.kcPFiColor()}}])}return this.each(function(){a(this).wpColorPicker().addClass("hasColorpicker")})};a.fn.kcPFiDate=function(c){if(!this.length){return this}if(Modernizr.inputtypes.date!==false){return this}var d=a(this);if(typeof a.fn.datepicker!=="function"){return Modernizr.load([{load:kcGetSNS("jquery_ui_datepicker",win.kcSettings.js).concat(kcGetSNS("jquery_ui",win.kcSettings.css)),complete:function(){d.kcPFiDate(c)}}])}return this.each(function(){a(this).datepicker(c)})};b.on("click","a.kc-help-trigger",function(f){f.preventDefault();var d=a(this),c=a(d.attr("href"));if(!a("#screen-options-wrap").is(":hidden")){a("#show-settings-link").trigger("click");setTimeout(function(){a("#contextual-help-link").click()},500)}else{a("#contextual-help-link").click()}a("#screen-meta").kcGoto();if(c.length){setTimeout(function(){a("> a",c).click()},700)}});if(!Modernizr.details){b.on("click","summary",function(f){if(a(f.target).is("a")){return}var c=a(this),d=c.parent();if(d.attr("open")){d.removeAttr("open")}else{d.attr("open","open")}})}})(jQuery);